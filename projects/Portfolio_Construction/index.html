<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Portfolio Construction | Tommaso de Martino </title> <meta name="author" content="Tommaso de Martino"> <meta name="description" content="Markowitz Approach to Portfolio Construction"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/favicon.png?1d8de0bac7da496e8c69cdbb6842c663"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://tdistudent27.github.io/projects/Portfolio_Construction/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> Tommaso de Martino </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">Projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Portfolio Construction</h1> <p class="post-description">Markowitz Approach to Portfolio Construction</p> </header> <article> <h2 id="introduction">Introduction</h2> <p>This project was carried out by <strong>Tommaso de Martino</strong> (Sapienza University of Rome), Health Sector by <a href="https://www.linkedin.com/in/sahar-shirazi-906b3a167/" rel="external nofollow noopener" target="_blank"><strong>Sahar Shirazi</strong></a> (Sapienza University of Rome), <strong>Alberto Pio Stigliani</strong> (Sapienza University of Rome), and <a href="https://www.linkedin.com/in/robert-roman-998b99213/?utm_source=share&amp;utm_campaign=share_via&amp;utm_content=profile&amp;utm_medium=ios_app" rel="external nofollow noopener" target="_blank"><strong>Robert Roman</strong></a> (Sapienza University of Rome). Each of us focused on a specific Machine Learning model:</p> <h2 id="1-markowitz-portfolio-optimization">1. Markowitz Portfolio Optimization</h2> <p>The <strong>Markowitz approach</strong> for portfolio optimization, known as the <strong>efficient frontier theory</strong>, is a theoretical model that helps investors build a portfolio that maximizes expected return for each level of risk or, conversely, minimizes risk for a given level of return.</p> <h3 id="1-assumptions-of-markowitzs-theory">1. Assumptions of Markowitz’s Theory</h3> <p>1) Investors want to maximize return and minimize risk</p> <p>2) The risk of a portfolio can be reduced through <strong>diversification</strong></p> <h3 id="2-expected-return-and-volatility">2. Expected Return and Volatility</h3> <p>Markowitz takes into account two main metrics for evaluating the portfolio</p> <p><strong>1) Expected Return:</strong> The weighted average of the expected returns of the assets in the portfolio. It represents how much can be earned on average by investing in that portfolio.</p> <p><strong>2) Risk or Volatility:</strong> The standard deviation of the portfolio’s returns, which measures the variability or uncertainty associated with that return</p> <h3 id="3-correlation-and-the-covariance-matrix">3. Correlation and the Covariance Matrix</h3> <p>The risk of a portfolio is not just the sum of the risks of the individual assets, but also depends on the <strong>correlation</strong> between them. The <strong>covariance matrix</strong> reflects how assets move together, allowing the calculation of the total risk of the portfolio accurately.</p> <p><strong>Diversification and correlation:</strong> A portfolio can have lower risk than the individual assets thanks to diversification since if some assets go up while others go down, the combined effect can reduce the overall volatility.</p> <h3 id="4-efficient-frontier">4. Efficient Frontier</h3> <p>Markowitz demonstrates that, by combining assets in various proportions, it’s possible to trace a <strong>curve of optimal portfolios</strong> called the <strong>efficient frontier</strong>.</p> <ul> <li>Each portfolio represents the maximum possible return for a given level of risk.</li> <li>Any portfolio outside the frontier is less efficient since it offers a lower return for the same level of risk.</li> </ul> <h3 id="5-the-portfolio-with-the-highest-sharpe-ratio-tangency-portfolio">5. The Portfolio with the Highest Sharpe Ratio (Tangency Portfolio)</h3> <p>A special point on the efficient frontier is the tangency portfolio, which has the highest Sharpe Ratio.</p> <p>This portfolio offers the best possible return for each unit of risk, making it an ideal portfolio for those who want the best risk-return trade-off.</p> <h3 id="6-optimal-portfolio">6. Optimal Portfolio</h3> <p>According to Markowitz’s theory, if looking for an optimal trade-off between risk and return, the tangency portfolio with the highest Sharpe Ratio is theoretically the best choice.</p> <h2 id="2-our-approach">2. Our Approach</h2> <p>We are going to proceed as follows:</p> <p><strong>APPROACH 1:</strong> We will use a <strong>Monte Carlo simulation</strong> approach to calculate the <strong>efficient frontier</strong> and then find the portfolio with the maximum <strong>Sharpe Ratio</strong> between those generated.</p> <p><strong>APPROACH 2:</strong> We will solve an <strong>Optimization Problem</strong> to find the <strong>Optimal Portfolio</strong></p> <p>Once we have the 2 portfolios found by the 2 approaches for each sector we can compare the results</p> <h2 id="3-variables-legend">3. Variables legend</h2> <p>It’s important to say that to avoid overwriting of variables we are going to define the variables with the following logic:</p> <p><strong>(name of the variable)_(initial letters of the sector)</strong></p> <p>So, for example, the data for the financial sector will be called:</p> <ul> <li><strong>data_fs</strong></li> </ul> <p>where <strong>fs</strong> means <strong>financial sector</strong></p> <h2 id="4-from-sector-portfolio-to-general-portfolio">4. From Sector-Portfolio to General-Portfolio</h2> <p>We are going to perform the 2 approaches for 4 sectors in the Economy and we are going to pick the 3 stocks (if available) with more weight in each sector.</p> <p>The 4 sectors are:</p> <ol> <li> <p>Financial Sector - <strong>Tommaso de Martino</strong></p> </li> <li> <p>Energy Sector - <strong>Alberto Pio Stigliani</strong></p> </li> <li> <p>Technology Sector - <a href="https://www.linkedin.com/in/robert-roman-998b99213/?utm_source=share&amp;utm_campaign=share_via&amp;utm_content=profile&amp;utm_medium=ios_app" rel="external nofollow noopener" target="_blank"><strong>Robert Roman</strong></a></p> </li> <li> <p>Health Sector - <a href="https://www.linkedin.com/in/sahar-shirazi-906b3a167/" rel="external nofollow noopener" target="_blank"><strong>Sahar Shirazi</strong></a></p> </li> </ol> <p>We will end up with maximum 3 stocks for each sector which will be used in the final optimization problem.</p> <h2 id="5-libraries">5. Libraries</h2> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">import</span> <span class="n">matplotlib.pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">import</span> <span class="n">numpy</span> <span class="k">as</span> <span class="n">np</span>
<span class="kn">import</span> <span class="n">yfinance</span> <span class="k">as</span> <span class="n">yf</span>
<span class="kn">from</span> <span class="n">datetime</span> <span class="kn">import</span> <span class="n">datetime</span>
<span class="kn">from</span> <span class="n">scipy</span> <span class="kn">import</span> <span class="n">optimize</span>
<span class="kn">from</span> <span class="n">scipy.optimize</span> <span class="kn">import</span> <span class="n">minimize</span>

</code></pre></div></div> <h2 id="6-financial-sector-by-tommaso-de-martino">6. Financial Sector by <strong>Tommaso de Martino</strong> </h2> <p>Finance companies facilitate different financial transactions, which are crucial for an economy to function well. Additionally, they provide many services to businesses and individuals alike, allowing for more control over financial decisions for the average person.</p> <p>Some of the standard financial companies that exist today include:</p> <p>1) Banks</p> <p>2) Credit unions</p> <p>3) Insurance companies</p> <p>4) Investment companies</p> <p>5) Brokerage firms</p> <p>6) Sales finance and consumer finance companies</p> <h3 id="how-do-we-choose-these-companies">How do we choose these companies?</h3> <h4 id="msci-world-financials-index"><strong>MSCI World Financials Index</strong></h4> <p>The <a href="https://www.msci.com/indexes/index/106802" rel="external nofollow noopener" target="_blank"><strong>MSCI World Financials Index</strong></a> captures large and mid cap representation across Developed Markets countries. All securities in the index are classified in the Financials sector as per the <strong>Global Industry Classification Standard (GICS®)</strong>.</p> <p><a href="https://www.msci.com/our-solutions/indexes/gics" rel="external nofollow noopener" target="_blank"><strong>Global Industry Classification Standard (GICS®):</strong></a> is an industry analysis framework that helps investors understand the key business activities for companies around the world. MSCI and S&amp;P Dow Jones Indices developed this classification standard to provide investors with consistent and exhaustive industry definitions.</p> <p>The top 10 constituents of the MSI World Financial Index are: 1) JPMORGAN CHASE &amp; CO</p> <p>2) BERKSHIRE HATHAWAY B</p> <p>3) VISA A</p> <p>4) MASTERCARD A</p> <p>5) BANK OF AMERICA CORP</p> <p>6) WELLS FARGO &amp; CO</p> <p>7) ROYAL BANK OF CANADA</p> <p>8) HSBC HOLDINGS (GB)</p> <p>9) GOLDMAN SACHS GROUP</p> <p>10) COMMONWEALTH BANK OF AUS</p> <h3 id="data-preprocessing">Data preprocessing</h3> <p>First of all let’s define the ticker and import daily data for this portfolio.</p> <p>It’s important to specify that we will work on the adjusted close data and from them we will derive the log-returns</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Tickers list
</span><span class="n">tickers_fs</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">JPM</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">BRK-B</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">V</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">MA</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">BAC</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">WFC</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">RY</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">HSBC</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">GS</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">CBA.AX</span><span class="sh">"</span><span class="p">]</span>
<span class="c1"># Dictionary to store stocks' name
</span><span class="n">ticker_name_fs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">"</span><span class="s">JPM</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">JPMORGAN CHASE &amp; CO</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">BRK-B</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">BERKSHIRE HATHAWAY B</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">V</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">VISA A</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">MA</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">MASTERCARD A</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">BAC</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">BANK OF AMERICA CORP</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">WFC</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">WELLS FARGO &amp; CO</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">RY</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">ROYAL BANK OF CANADA</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">HSBC</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">HSBC HOLDINGS (GB)</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">GS</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">GOLDMAN SACHS GROUP</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">CBA.AX</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">COMMONWEALTH BANK OF AUS</span><span class="sh">"</span>
<span class="p">}</span>


<span class="c1"># Setting the dates
</span><span class="n">start_date</span> <span class="o">=</span> <span class="sh">"</span><span class="s">2020-01-01</span><span class="sh">"</span>
<span class="n">end_date</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="nf">today</span><span class="p">().</span><span class="nf">strftime</span><span class="p">(</span><span class="sh">'</span><span class="s">%Y-%m-%d</span><span class="sh">'</span><span class="p">)</span>

<span class="c1"># Importing the data
</span><span class="n">data_fs</span> <span class="o">=</span> <span class="n">yf</span><span class="p">.</span><span class="nf">download</span><span class="p">(</span><span class="n">tickers_fs</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span> <span class="n">start_date</span> <span class="p">,</span> <span class="n">end</span><span class="o">=</span> <span class="n">end_date</span> <span class="p">)[</span><span class="sh">'</span><span class="s">Adj Close</span><span class="sh">'</span><span class="p">]</span>
<span class="nf">print</span><span class="p">(</span><span class="n">data_fs</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>[*********************100%***********************]  10 of 10 completed

Ticker                           BAC       BRK-B      CBA.AX          GS  \
Date                                                                       
2020-01-02 00:00:00+00:00  31.647984  228.389999   65.844452  208.356293   
2020-01-03 00:00:00+00:00  30.990875  226.179993   66.198891  205.919891   
2020-01-06 00:00:00+00:00  30.946470  226.990005   65.753777  208.027298   
2020-01-07 00:00:00+00:00  30.742239  225.919998   66.932518  209.396652   
2020-01-08 00:00:00+00:00  31.053032  225.990005   66.685242  211.415146   
...                              ...         ...         ...         ...   
2024-11-19 00:00:00+00:00  46.410000  468.859985  155.610001  581.380005   
2024-11-20 00:00:00+00:00  46.060001  468.829987  156.380005  581.929993   
2024-11-21 00:00:00+00:00  46.459999  472.059998  156.240005  596.109985   
2024-11-22 00:00:00+00:00  47.000000  476.570007  159.029999  602.780029   
2024-11-25 00:00:00+00:00  47.500000  477.429993  160.139999  603.030029   

Ticker                          HSBC         JPM          MA          RY  \
Date                                                                       
2020-01-02 00:00:00+00:00  29.879021  122.104614  295.023865   65.949982   
2020-01-03 00:00:00+00:00  29.416080  120.493271  292.145569   65.718315   
2020-01-06 00:00:00+00:00  29.317415  120.397453  292.923431   65.858978   
2020-01-07 00:00:00+00:00  29.097328  118.350624  291.931641   65.676918   
2020-01-08 00:00:00+00:00  29.029024  119.273888  297.082550   66.074120   
...                              ...         ...         ...         ...   
2024-11-19 00:00:00+00:00  46.279999  243.089996  519.460022  122.900002   
2024-11-20 00:00:00+00:00  46.230000  240.779999  512.539978  121.790001   
2024-11-21 00:00:00+00:00  46.320000  244.759995  515.099976  125.089996   
2024-11-22 00:00:00+00:00  45.939999  248.550003  520.859985  125.080002   
2024-11-25 00:00:00+00:00  46.490002  250.289993  526.599976  124.320000   

Ticker                              V        WFC  
Date                                              
2020-01-02 00:00:00+00:00  184.487366  47.053131  
2020-01-03 00:00:00+00:00  183.020096  46.764248  
2020-01-06 00:00:00+00:00  182.624329  46.484104  
2020-01-07 00:00:00+00:00  182.141678  46.098942  
2020-01-08 00:00:00+00:00  185.259567  46.239006  
...                               ...        ...  
2024-11-19 00:00:00+00:00  311.850006  73.430000  
2024-11-20 00:00:00+00:00  307.390015  73.580002  
2024-11-21 00:00:00+00:00  309.899994  74.830002  
2024-11-22 00:00:00+00:00  309.920013  75.959999  
2024-11-25 00:00:00+00:00  313.190002  76.900002  

[1267 rows x 10 columns]
</code></pre></div></div> <h2 id="daily-log-returns">Daily Log Returns</h2> <p>First of all, we need to calculate the <strong>daily logarithmic returns</strong> based on Adjusted Close prices. Logarithmic returns are preferred to simple returns since they have 2 useful properties:</p> <p>1) Simmetry</p> <p>2) Time - Additivity</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Log Returns
</span><span class="n">log_returns_fs</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">log</span><span class="p">(</span><span class="n">data_fs</span> <span class="o">/</span> <span class="n">data_fs</span><span class="p">.</span><span class="nf">shift</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">log_returns_fs</span> <span class="o">=</span> <span class="n">log_returns_fs</span><span class="p">.</span><span class="nf">dropna</span><span class="p">()</span>

</code></pre></div></div> <p>Now we are going to plot the daily logarithmic returns</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">log_returns_df_fs</span> <span class="o">=</span> <span class="n">log_returns_fs</span><span class="p">.</span><span class="nf">reset_index</span><span class="p">()</span>  <span class="c1"># index reset to include date column
</span><span class="n">log_returns_df_fs</span> <span class="o">=</span> <span class="n">log_returns_df_fs</span><span class="p">.</span><span class="nf">melt</span><span class="p">(</span><span class="n">id_vars</span><span class="o">=</span><span class="sh">"</span><span class="s">Date</span><span class="sh">"</span><span class="p">,</span> <span class="n">var_name</span><span class="o">=</span><span class="sh">"</span><span class="s">Company</span><span class="sh">"</span><span class="p">,</span> <span class="n">value_name</span><span class="o">=</span><span class="sh">"</span><span class="s">Daily LogReturn</span><span class="sh">"</span><span class="p">)</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">px</span><span class="p">.</span><span class="nf">line</span><span class="p">(</span><span class="n">log_returns_df_fs</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="sh">"</span><span class="s">Date</span><span class="sh">"</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="sh">"</span><span class="s">Daily LogReturn</span><span class="sh">"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="sh">"</span><span class="s">Company</span><span class="sh">"</span><span class="p">,</span>
              <span class="n">title</span><span class="o">=</span><span class="sh">"</span><span class="s">Daily LogReturns of Stocks</span><span class="sh">"</span><span class="p">)</span>
<span class="n">fig</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>
</code></pre></div></div> <h2 id="approach-1---monte-carlo">Approach 1 - Monte Carlo</h2> <h3 id="formulas-that-we-will-use">Formulas that we will use</h3> <ol> <li> <p><strong>Annualized expected return</strong></p> </li> <li> <p><strong>Annualized expected volatility</strong></p> </li> <li> <p><strong>Sharpe Ratio</strong></p> </li> </ol> <h3 id="1-annualized-expected-return">1. Annualized expected return</h3> \[\text{Annualized expected return} = ( \mathbf{w}^T \cdot \mu ) \cdot 252\] <p>where:</p> <ul> <li>$\mathbf{w}$ is the weight vector of the portfolio.</li> <li>$\mu$ is the vector of the average daily log returns of each asset.</li> <li>$252$ is the annualization factor based on the approximate number of trading days in a year.</li> </ul> <p>or, in expanded form:</p> \[\text{Annualized expected return} = \left( \sum (\text{log\_returns} \times \text{weights}) \right) \times 252\] <p><strong>In the code it will be</strong></p> <ul> <li> <p>first of all let us assume that in a year there are <strong>252 trading days</strong></p> </li> <li> <p><strong>‘log_returns.mean()’</strong> computes the average daily return for each security in the <strong>‘log_returns’</strong> dataset, which contains the daily logarithmic returns of securities</p> </li> <li> <p><strong>‘log_returns.mean().dot(weights)’</strong> computes the scalar product between the average daily return of each security and the portfolio weights</p> </li> <li> <p><strong>‘log_returns.mean().dot(weights) * 252’</strong> here the weighted average of daily returns is multiplied by <strong>252</strong> to obtain the portfolio’s annualized expected return.</p> </li> </ul> <h3 id="2-annualized-expected-volatility">2. Annualized expected volatility</h3> <p>We are going to write a code that computes the <strong>annualized expected volatility</strong> in a <strong>matrix form</strong></p> \[\text{Annualized Expected Volatility} = \sqrt{w^T \cdot (252 \cdot \Sigma) \cdot w}\] <p>where:</p> <ul> <li>$w$ is the <strong>weight vector</strong> of the portfolio, representing the proportion of each asset.</li> <li>$\Sigma$ is the <strong>daily covariance matrix</strong> of asset returns.</li> <li>$252$ is the <strong>annualization factor</strong>, based on the approximate number of trading days in a year.</li> </ul> <p><strong>In the code it will be</strong></p> <ul> <li> <p><strong>‘log_returns.cov()’</strong> computes the covariance matrix of daily (logarithmic) returns for all securities in the portfolio</p> </li> <li> <p><strong>‘252 * log_returns.cov()’</strong> covariance annualized</p> </li> <li> <p><strong>‘log_returns.cov().dot(weights)’</strong> we multiply the covariance matrix by the weight vector to reflect the risk contribution of each security</p> </li> <li> <p><strong>‘weights.T.dot’</strong> multiplication of the transposed weights obtaining the weighted sum of the covariances, which represents the total variance of the portfolio</p> </li> </ul> <h3 id="3-sharpe-ratio">3. Sharpe Ratio</h3> <p>The Sharpe ratio compares the return of an investment with its risk</p> \[\text{Sharpe Ratio} = \frac{E[R_p] - R_f}{\sigma_p}\] <p>Where:</p> <ul> <li>$E[R_p]$ is the $\textbf{expected return of the portfolio}$,</li> <li>$R_f$ is the $\textbf{risk-free rate}$,</li> <li>$\sigma_p$ is the $\textbf{volatility of the portfolio (standard deviation of the portfolio’s returns)}$.</li> </ul> <h3 id="risk-free-rate">Risk-free rate</h3> <p>We can use the <strong>3-Month Treasury Bill</strong></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">ticker_rf</span> <span class="o">=</span> <span class="sh">"</span><span class="s">^IRX</span><span class="sh">"</span>
<span class="n">rf_data</span> <span class="o">=</span> <span class="n">yf</span><span class="p">.</span><span class="nf">download</span><span class="p">(</span><span class="n">ticker_rf</span><span class="p">,</span> <span class="n">start</span><span class="o">=</span><span class="n">start_date</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="n">end_date</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">rf_data</span><span class="p">)</span>
<span class="n">rf</span> <span class="o">=</span> <span class="n">rf_data</span><span class="p">[</span><span class="sh">'</span><span class="s">Adj Close</span><span class="sh">'</span><span class="p">].</span><span class="n">iloc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">].</span><span class="n">values</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">100</span>
<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">"</span><span class="s">Risk-free rate (rf) in decimal: </span><span class="si">{</span><span class="n">rf</span><span class="si">}</span><span class="sh">"</span><span class="p">)</span>
</code></pre></div></div> <p>[<strong>**</strong><strong>**</strong><strong>**</strong><strong><em>100%</em></strong><strong>**</strong><strong>**</strong><strong>**</strong>**] 1 of 1 completed</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Price                     Adj Close  Close   High    Low   Open Volume
Ticker                         ^IRX   ^IRX   ^IRX   ^IRX   ^IRX   ^IRX
Date                                                                  
2020-01-02 00:00:00+00:00     1.495  1.495  1.510  1.495  1.510      0
2020-01-03 00:00:00+00:00     1.473  1.473  1.490  1.460  1.490      0
2020-01-06 00:00:00+00:00     1.488  1.488  1.490  1.475  1.478      0
2020-01-07 00:00:00+00:00     1.500  1.500  1.505  1.500  1.505      0
2020-01-08 00:00:00+00:00     1.493  1.493  1.493  1.485  1.493      0
...                             ...    ...    ...    ...    ...    ...
2024-11-19 00:00:00+00:00     4.408  4.408  4.410  4.403  4.408      0
2024-11-20 00:00:00+00:00     4.410  4.410  4.415  4.410  4.410      0
2024-11-21 00:00:00+00:00     4.413  4.413  4.413  4.400  4.403      0
2024-11-22 00:00:00+00:00     4.415  4.415  4.420  4.408  4.408      0
2024-11-25 00:00:00+00:00     4.405  4.405  4.413  4.403  4.413      0

[1234 rows x 6 columns]
Risk-free rate (rf) in decimal: 0.0440500020980835
</code></pre></div></div> <p>Now we are ready to compute the <strong>Benchmark-Sharpe Ratio</strong></p> <h3 id="monte-carlo-simulation">Monte Carlo simulation</h3> <p>This for loop simulates 100,000 random portfolios and calculates for each:</p> <ul> <li>Normalized random weights,</li> <li>Annualized expected return,</li> <li>Annualized volatility,</li> <li>Sharpe Ratio.</li> </ul> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># set seed for reproducibility
</span>
<span class="c1"># number of simulations
</span><span class="n">n</span> <span class="o">=</span> <span class="mi">100_000</span> <span class="c1"># it could take some minutes
</span>
<span class="n">port_weights_fs</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="nf">len</span><span class="p">(</span><span class="n">data_fs</span><span class="p">.</span><span class="n">columns</span><span class="p">)))</span>
<span class="n">port_volatility_fs</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">port_sr_fs</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">port_return_fs</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">zeros</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="n">nume_securities_fs</span> <span class="o">=</span> <span class="nf">len</span><span class="p">(</span><span class="n">data_fs</span><span class="p">.</span><span class="n">columns</span><span class="p">)</span>

<span class="c1"># generation of random portfolios with random normalized weights (sum to 1)
</span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
    <span class="c1"># Weight each security
</span>    <span class="n">weights_fs</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="n">random</span><span class="p">.</span><span class="nf">random</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">data_fs</span><span class="p">.</span><span class="n">columns</span><span class="p">))</span> <span class="c1"># np.random.random only produces non-negative values
</span>    <span class="c1"># normalize it, so that sum is one
</span>    <span class="n">weights_fs</span> <span class="o">/=</span> <span class="n">np</span><span class="p">.</span><span class="nf">sum</span><span class="p">(</span><span class="n">weights_fs</span><span class="p">)</span>
    <span class="n">port_weights_fs</span><span class="p">[</span><span class="n">i</span><span class="p">,:]</span> <span class="o">=</span> <span class="n">weights_fs</span> <span class="c1"># 'i' indicates the specific iteration (i.e. the current portfolio in the simulation).
</span>                                <span class="c1"># ':' indicates that we are saving all the weights generated for this portfolio (i.e. for each security)
</span>
    <span class="c1"># Calculation of the annualized expected return
</span>    <span class="n">exp_ret_fs</span> <span class="o">=</span> <span class="n">log_returns_fs</span><span class="p">.</span><span class="nf">mean</span><span class="p">().</span><span class="nf">dot</span><span class="p">(</span><span class="n">weights_fs</span><span class="p">)</span> <span class="o">*</span> <span class="mi">252</span>
    <span class="n">port_return_fs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">exp_ret_fs</span> <span class="c1"># save this value in the port_return array at position i, corresponding to the current simulation.
</span>
    <span class="c1"># Annualized expected volatility
</span>    <span class="n">exp_vol_fs</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">weights_fs</span><span class="p">.</span><span class="n">T</span><span class="p">.</span><span class="nf">dot</span><span class="p">(</span><span class="mi">252</span> <span class="o">*</span> <span class="n">log_returns_fs</span><span class="p">.</span><span class="nf">cov</span><span class="p">().</span><span class="nf">dot</span><span class="p">(</span><span class="n">weights_fs</span><span class="p">)))</span>
    <span class="n">port_volatility_fs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">exp_vol_fs</span>

    <span class="c1"># Sharpe Ratio
</span>    <span class="n">sr_fs</span> <span class="o">=</span> <span class="p">(</span><span class="n">exp_ret_fs</span> <span class="o">-</span> <span class="n">rf</span><span class="p">)</span> <span class="o">/</span> <span class="n">exp_vol_fs</span>
    <span class="n">port_sr_fs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">sr_fs</span>
</code></pre></div></div> <h3 id="identification-of-best-portfolio">Identification of best portfolio</h3> <p>Now we are going to manually call the best portfolio (not oprimal since it is not an optimization problem), i.e. the portfolio with the maximum <strong>Sharpe Ratio</strong> between those generated</p> <p><strong>Note that:</strong> It is not necessarily true that this portfolio will be the same as the one resulting from solving the optimization problem, i.e. directly maximizing the <strong>Sharpe Ratio</strong></p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Index of max Sharpe Ratio
</span><span class="n">max_sr_fs</span> <span class="o">=</span> <span class="n">port_sr_fs</span><span class="p">.</span><span class="nf">max</span><span class="p">()</span>
<span class="n">ind_fs</span> <span class="o">=</span> <span class="n">port_sr_fs</span><span class="p">.</span><span class="nf">argmax</span><span class="p">()</span>
<span class="c1"># Return and Volatility at Max SR
</span><span class="n">max_sr_ret_fs</span> <span class="o">=</span> <span class="n">port_return_fs</span><span class="p">[</span><span class="n">ind_fs</span><span class="p">]</span>
<span class="n">max_sr_vol_fs</span> <span class="o">=</span> <span class="n">port_volatility_fs</span><span class="p">[</span><span class="n">ind_fs</span><span class="p">]</span>
</code></pre></div></div> <h3 id="monte-carlo-portfolio-weights">Monte Carlo Portfolio Weights</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">for</span> <span class="n">weight</span><span class="p">,</span> <span class="n">stock</span> <span class="ow">in</span> <span class="nf">sorted</span><span class="p">(</span><span class="nf">zip</span><span class="p">(</span><span class="n">port_weights_fs</span><span class="p">[</span><span class="n">ind_fs</span><span class="p">],</span> <span class="n">data_fs</span><span class="p">.</span><span class="n">columns</span><span class="p">),</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">reverse</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="si">{</span><span class="nf">round</span><span class="p">(</span><span class="n">weight</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s"> % of </span><span class="si">{</span><span class="n">stock</span><span class="si">}</span><span class="s"> should be bought.</span><span class="sh">'</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="se">\n</span><span class="s">Monte Carlo portfolio return is : </span><span class="si">{</span><span class="nf">round</span><span class="p">(</span><span class="n">max_sr_ret_fs</span> <span class="o">*</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s">% with volatility </span><span class="si">{</span><span class="n">max_sr_vol_fs</span><span class="si">}</span><span class="s"> and Sharpe Ratio </span><span class="si">{</span><span class="n">max_sr_fs</span><span class="si">}</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>37.08 % of COMMONWEALTH BANK OF AUS should be bought.
33.2 % of GOLDMAN SACHS GROUP should be bought.
11.09 % of WELLS FARGO &amp; CO should be bought.
6.34 % of ROYAL BANK OF CANADA should be bought.
4.79 % of BERKSHIRE HATHAWAY B should be bought.
3.03 % of VISA A should be bought.
2.02 % of JPMORGAN CHASE &amp; CO should be bought.
1.36 % of MASTERCARD A should be bought.
0.84 % of BANK OF AMERICA CORP should be bought.
0.26 % of HSBC HOLDINGS (GB) should be bought.

Monte Carlo portfolio return is : 17.84% with volatility 0.2350763868947315 and Sharpe Ratio 0.571580612208514
</code></pre></div></div> <ul> <li> <p><strong>zip(port_weights[ind], stocks)</strong>: Matches each weight of the optimal portfolio (found by the index ‘ind’) with the corresponding asset in the data list</p> </li> <li> <p><strong>sort</strong> is just to have the results in a decreasing way</p> </li> <li> <p>The <strong>round</strong> function is used to round a number to a specified number of decimal places.</p> </li> </ul> <h3 id="monte-carlo-efficient-frontier">Monte Carlo Efficient Frontier</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># function to minimize volatility
</span><span class="k">def</span> <span class="nf">minimize_volatility</span><span class="p">(</span><span class="n">weights_fs</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">weights_fs</span><span class="p">.</span><span class="n">T</span><span class="p">.</span><span class="nf">dot</span><span class="p">(</span><span class="mi">252</span> <span class="o">*</span> <span class="n">log_returns_fs</span><span class="p">.</span><span class="nf">cov</span><span class="p">().</span><span class="nf">dot</span><span class="p">(</span><span class="n">weights_fs</span><span class="p">)))</span>

<span class="c1"># range of target_returns to efficient frontier
</span><span class="n">target_returns_fs</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="n">port_return_fs</span><span class="p">.</span><span class="nf">min</span><span class="p">(),</span> <span class="n">port_return_fs</span><span class="p">.</span><span class="nf">max</span><span class="p">()</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

<span class="c1"># Comuputation of efficient frontier
</span><span class="n">efficient_volatilities_fs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">target_return_fs</span> <span class="ow">in</span> <span class="n">target_returns_fs</span><span class="p">:</span>
    <span class="c1"># Constraints: sum of weights = 1 and return = target_return
</span>    <span class="n">constraints_fs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="p">{</span><span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">eq</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">fun</span><span class="sh">'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">np</span><span class="p">.</span><span class="nf">sum</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">},</span>  <span class="c1"># sum of weights = 1
</span>        <span class="p">{</span><span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">:</span> <span class="sh">'</span><span class="s">eq</span><span class="sh">'</span><span class="p">,</span> <span class="sh">'</span><span class="s">fun</span><span class="sh">'</span><span class="p">:</span> <span class="k">lambda</span> <span class="n">w</span><span class="p">:</span> <span class="n">log_returns_fs</span><span class="p">.</span><span class="nf">mean</span><span class="p">().</span><span class="nf">dot</span><span class="p">(</span><span class="n">w</span><span class="p">)</span> <span class="o">*</span> <span class="mi">252</span> <span class="o">-</span> <span class="n">target_return_fs</span><span class="p">}</span>  <span class="c1"># target return
</span>    <span class="p">]</span>
    <span class="n">bounds_fs</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">data_fs</span><span class="p">.</span><span class="n">columns</span><span class="p">))]</span>  <span class="c1"># every weights between 0 and 1
</span>    <span class="n">initial_guess_fs</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">ones</span><span class="p">(</span><span class="nf">len</span><span class="p">(</span><span class="n">data_fs</span><span class="p">.</span><span class="n">columns</span><span class="p">))</span> <span class="o">/</span> <span class="nf">len</span><span class="p">(</span><span class="n">data_fs</span><span class="p">.</span><span class="n">columns</span><span class="p">)</span>  <span class="c1"># unifrom weight
</span>
    <span class="c1"># minimize volatility for target return
</span>    <span class="n">result_fs</span> <span class="o">=</span> <span class="nf">minimize</span><span class="p">(</span><span class="n">minimize_volatility</span><span class="p">,</span> <span class="n">initial_guess_fs</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="sh">'</span><span class="s">SLSQP</span><span class="sh">'</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds_fs</span><span class="p">,</span> <span class="n">constraints</span><span class="o">=</span><span class="n">constraints_fs</span><span class="p">)</span>
    <span class="n">efficient_volatilities_fs</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">result_fs</span><span class="p">.</span><span class="n">fun</span><span class="p">)</span>
</code></pre></div></div> <p><img src="/assets/proj/Portfolio_Construction_files/fs_1.png" alt="fs1" style="max-width: 100%; height: auto;"></p> <h2 id="approach-2---optimization-problem">Approach 2 - Optimization Problem</h2> <h3 id="returns-and-covariance">Returns and Covariance</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Annualized mean log return
</span><span class="n">log_returns_mean_fs</span> <span class="o">=</span> <span class="n">log_returns_fs</span><span class="p">.</span><span class="nf">mean</span><span class="p">()</span><span class="o">*</span><span class="mi">252</span>

<span class="c1"># Annualized covariance matrix
</span><span class="n">cov_fs</span> <span class="o">=</span> <span class="n">log_returns_fs</span><span class="p">.</span><span class="nf">cov</span><span class="p">()</span><span class="o">*</span><span class="mi">252</span>
</code></pre></div></div> <h3 id="functions">Functions</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Function to get return, volatility and Sharpe Ratio (Benchmark-Based Sharpe Ratio)
</span><span class="k">def</span> <span class="nf">get_ret_vol_sr</span><span class="p">(</span><span class="n">weights_fs</span><span class="p">):</span>
    <span class="n">weights_fs</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">(</span><span class="n">weights_fs</span><span class="p">)</span>  <span class="c1"># weights to a NumPy array
</span>    <span class="n">ret_fs</span> <span class="o">=</span> <span class="n">log_returns_mean_fs</span><span class="p">.</span><span class="nf">dot</span><span class="p">(</span><span class="n">weights_fs</span><span class="p">)</span>  <span class="c1"># expected portfolio return
</span>    <span class="n">vol_fs</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">sqrt</span><span class="p">(</span><span class="n">weights_fs</span><span class="p">.</span><span class="n">T</span><span class="p">.</span><span class="nf">dot</span><span class="p">(</span><span class="n">cov_fs</span><span class="p">.</span><span class="nf">dot</span><span class="p">(</span><span class="n">weights_fs</span><span class="p">)))</span>  <span class="c1"># portfolio volatility
</span>    <span class="n">sr_fs</span> <span class="o">=</span> <span class="p">(</span><span class="n">ret_fs</span> <span class="o">-</span> <span class="n">rf</span><span class="p">)</span> <span class="o">/</span> <span class="n">vol_fs</span>  <span class="c1"># Benchmark-Based Sharpe Ratio
</span>    <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="nf">array</span><span class="p">([</span><span class="n">ret_fs</span><span class="p">,</span> <span class="n">vol_fs</span><span class="p">,</span> <span class="n">sr_fs</span><span class="p">])</span>  <span class="c1"># Returns return, volatility, and the Sharpe Ratio
</span>

<span class="c1"># Negative Sharpe ratio as we need to max it but Scipy minimize the given function
</span><span class="k">def</span> <span class="nf">neg_sr</span><span class="p">(</span><span class="n">weights_fs</span><span class="p">):</span>
    <span class="k">return</span> <span class="nf">get_ret_vol_sr</span><span class="p">(</span><span class="n">weights_fs</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="o">-</span><span class="mi">1</span>  <span class="c1"># Returns the negative of the Sharpe Ratio
</span>

<span class="c1"># check sum of weights
</span><span class="k">def</span> <span class="nf">check_sum</span><span class="p">(</span><span class="n">weights_fs</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="p">.</span><span class="nf">sum</span><span class="p">(</span><span class="n">weights_fs</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>  <span class="c1"># Returns the difference between the sum of weights and 1 (Obviously it should be 0)
</span>

<span class="c1"># Constraints for the optimization problem
</span><span class="n">cons_fs</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">eq</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">fun</span><span class="sh">'</span><span class="p">:</span><span class="n">check_sum</span><span class="p">}</span> <span class="c1"># type = type of constraint
</span>                                     <span class="c1"># eq = equality
</span>                                     <span class="c1"># fun = function
</span>
<span class="c1"># Bounds on weights (NON-NEGATIVITY)
</span><span class="n">bounds_fs</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>

<span class="c1"># Initial guess for optimization to start with
</span><span class="n">init_guess_fs</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="o">/</span><span class="mi">10</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nf">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>  <span class="c1"># it starts with 10% to each asset
</span>

<span class="c1"># Call minimizer
</span><span class="n">opt_results_fs</span> <span class="o">=</span> <span class="n">optimize</span><span class="p">.</span><span class="nf">minimize</span><span class="p">(</span><span class="n">neg_sr</span><span class="p">,</span> <span class="n">init_guess_fs</span><span class="p">,</span> <span class="n">constraints</span><span class="o">=</span><span class="n">cons_fs</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds_fs</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="sh">'</span><span class="s">SLSQP</span><span class="sh">'</span><span class="p">)</span> <span class="c1"># SLSQP
</span>                                                                                                    <span class="c1"># (Sequential Least Squares Programming)
</span></code></pre></div></div> <h3 id="optimal-weights">Optimal Weights</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">optimal_weights_fs</span> <span class="o">=</span> <span class="n">opt_results_fs</span><span class="p">.</span><span class="n">x</span>
<span class="c1"># optimal_weights
</span><span class="k">for</span> <span class="n">st</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">zip</span><span class="p">(</span><span class="n">data_fs</span><span class="p">,</span><span class="n">optimal_weights_fs</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">Stock </span><span class="si">{</span><span class="n">st</span><span class="si">}</span><span class="s"> has weight </span><span class="si">{</span><span class="n">np</span><span class="p">.</span><span class="nf">round</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s"> %</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Stock BANK OF AMERICA CORP has weight 0.0 %
Stock BERKSHIRE HATHAWAY B has weight 19.05 %
Stock COMMONWEALTH BANK OF AUS has weight 53.71 %
Stock GOLDMAN SACHS GROUP has weight 27.24 %
Stock HSBC HOLDINGS (GB) has weight 0.0 %
Stock JPMORGAN CHASE &amp; CO has weight 0.0 %
Stock MASTERCARD A has weight 0.0 %
Stock ROYAL BANK OF CANADA has weight 0.0 %
Stock VISA A has weight 0.0 %
Stock WELLS FARGO &amp; CO has weight 0.0 %
</code></pre></div></div> <h3 id="monte-carlo-weights">Monte Carlo weights</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">monte_c_weights_fs</span> <span class="o">=</span> <span class="n">port_weights_fs</span><span class="p">[</span><span class="n">ind_fs</span><span class="p">]</span>
<span class="k">for</span> <span class="n">st</span><span class="p">,</span> <span class="n">i</span> <span class="ow">in</span> <span class="nf">zip</span><span class="p">(</span><span class="n">data_fs</span><span class="p">,</span><span class="n">monte_c_weights_fs</span><span class="p">):</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="s">Stock </span><span class="si">{</span><span class="n">st</span><span class="si">}</span><span class="s"> has weight </span><span class="si">{</span><span class="n">np</span><span class="p">.</span><span class="nf">round</span><span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="mi">100</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s"> %</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Stock BANK OF AMERICA CORP has weight 0.84 %
Stock BERKSHIRE HATHAWAY B has weight 4.79 %
Stock COMMONWEALTH BANK OF AUS has weight 37.08 %
Stock GOLDMAN SACHS GROUP has weight 33.2 %
Stock HSBC HOLDINGS (GB) has weight 0.26 %
Stock JPMORGAN CHASE &amp; CO has weight 2.02 %
Stock MASTERCARD A has weight 1.36 %
Stock ROYAL BANK OF CANADA has weight 6.34 %
Stock VISA A has weight 3.03 %
Stock WELLS FARGO &amp; CO has weight 11.09 %
</code></pre></div></div> <h3 id="comparison">Comparison</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Weights
</span><span class="p">(</span><span class="n">optimal_weights_fs</span> <span class="o">-</span> <span class="n">monte_c_weights_fs</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>array([-0.00837525,  0.14258728,  0.16630205, -0.05954855, -0.00256049,
       -0.02016752, -0.01360042, -0.06338842, -0.03032042, -0.11092826])
</code></pre></div></div> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Metrics of the portfolios
</span><span class="nf">get_ret_vol_sr</span><span class="p">(</span><span class="n">optimal_weights_fs</span><span class="p">),</span> <span class="nf">get_ret_vol_sr</span><span class="p">(</span><span class="n">monte_c_weights_fs</span><span class="p">)</span>

<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">For a given portfolio we have: (Using Markowitz - SciPy)</span><span class="se">\n</span><span class="s"> </span><span class="se">\n</span><span class="sh">'</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="sh">'</span><span class="s">Return Volatility SharpeRatio</span><span class="sh">'</span><span class="p">.</span><span class="nf">split</span><span class="p">()):</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s"> is : </span><span class="si">{</span><span class="nf">get_ret_vol_sr</span><span class="p">(</span><span class="n">optimal_weights_fs</span><span class="p">)[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">"</span><span class="se">\n</span><span class="sh">"</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">For a given portfolio we have: (Using Monte Carlo)</span><span class="se">\n</span><span class="s"> </span><span class="se">\n</span><span class="sh">'</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="ow">in</span> <span class="nf">enumerate</span><span class="p">(</span><span class="sh">'</span><span class="s">Return Volatility SharpeRatio</span><span class="sh">'</span><span class="p">.</span><span class="nf">split</span><span class="p">()):</span>
    <span class="nf">print</span><span class="p">(</span><span class="sa">f</span><span class="sh">'</span><span class="si">{</span><span class="n">j</span><span class="si">}</span><span class="s"> is : </span><span class="si">{</span><span class="nf">get_ret_vol_sr</span><span class="p">(</span><span class="n">monte_c_weights_fs</span><span class="p">)[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="se">\n</span><span class="sh">'</span><span class="p">)</span>
</code></pre></div></div> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>For a given portfolio we have: (Using Markowitz - SciPy)
 

Return is : 0.1892723056031749

Volatility is : 0.2118498940779727

SharpeRatio is : 0.685496229002793



For a given portfolio we have: (Using Monte Carlo)
 

Return is : 0.17841510723513962

Volatility is : 0.23507638689473154

SharpeRatio is : 0.5715806122085139
</code></pre></div></div> <h3 id="efficient-frontier">Efficient Frontier</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">frontier_y_fs</span> <span class="o">=</span> <span class="n">np</span><span class="p">.</span><span class="nf">linspace</span><span class="p">(</span><span class="n">port_return_fs</span><span class="p">.</span><span class="nf">min</span><span class="p">(),</span> <span class="n">port_return_fs</span><span class="p">.</span><span class="nf">max</span><span class="p">()</span> <span class="o">*</span> <span class="mf">1.1</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
<span class="n">frontier_vol_fs</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">def</span> <span class="nf">minimize_vol</span><span class="p">(</span><span class="n">weights_fs</span><span class="p">):</span>
    <span class="k">return</span> <span class="nf">get_ret_vol_sr</span><span class="p">(</span><span class="n">weights_fs</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

<span class="k">for</span> <span class="n">possible_ret_fs</span> <span class="ow">in</span> <span class="n">frontier_y_fs</span><span class="p">:</span>
    <span class="n">cons_fs</span> <span class="o">=</span> <span class="p">({</span><span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">eq</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">fun</span><span class="sh">'</span><span class="p">:</span><span class="n">check_sum</span><span class="p">},</span>
            <span class="p">{</span><span class="sh">'</span><span class="s">type</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">eq</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">fun</span><span class="sh">'</span><span class="p">:</span><span class="k">lambda</span> <span class="n">w</span><span class="p">:</span><span class="nf">get_ret_vol_sr</span><span class="p">(</span><span class="n">w</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">possible_ret_fs</span><span class="p">})</span>
    <span class="n">result_fs</span> <span class="o">=</span> <span class="n">optimize</span><span class="p">.</span><span class="nf">minimize</span><span class="p">(</span><span class="n">minimize_vol</span><span class="p">,</span> <span class="n">init_guess_fs</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="sh">'</span><span class="s">SLSQP</span><span class="sh">'</span><span class="p">,</span> <span class="n">constraints</span><span class="o">=</span><span class="n">cons_fs</span><span class="p">,</span> <span class="n">bounds</span><span class="o">=</span><span class="n">bounds_fs</span><span class="p">)</span>
    <span class="n">frontier_vol_fs</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="n">result_fs</span><span class="p">[</span><span class="sh">'</span><span class="s">fun</span><span class="sh">'</span><span class="p">])</span>
</code></pre></div></div> <p><img src="/assets/proj/Portfolio_Construction_files/fs_2.png" alt="fs2" style="max-width: 100%; height: auto;"></p> <h1 id="7-energy-sector-by-alberto-pio-stigliani">7. Energy Sector by <strong>Alberto Pio Stigliani</strong> </h1> <blockquote> <p>NOTE:</p> <p>The approach is the same as the Financial Sector</p> </blockquote> <h2 id="data-processing">Data Processing</h2> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#Tickers list
</span><span class="n">tickers_es</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">XOM</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">CVX</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">COP</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">EOG</span><span class="sh">"</span><span class="p">,</span><span class="sh">"</span><span class="s">WMB</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">EPD</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">OKE</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">KMI</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">ET</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">SLB</span><span class="sh">"</span><span class="p">]</span>

<span class="c1">#Dict
</span><span class="n">ticker_name_es</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">"</span><span class="s">XOM</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Exxon Mobil Corporation</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">CVX</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Chevron Corporation</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">COP</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">ConocoPhillips</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">EOG</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">EOG Resources,</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">WMB</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Williams Companies Inc.</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">EPD</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Enterprise Products Partners</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">OKE</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">ONEOK</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">KMI</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Kinder Morgan</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">ET</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Energy Transfer</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">SLB</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Schlumberger</span><span class="sh">"</span>
<span class="p">}</span>
</code></pre></div></div> <h3 id="optimal-weights-1">Optimal Weights</h3> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Stock Chevron Corporation has weight 0.0 %
Stock ConocoPhillips has weight 0.0 %
Stock EOG Resources, has weight 0.0 %
Stock Energy Transfer has weight 0.0 %
Stock Enterprise Products Partners has weight 0.0 %
Stock Exxon Mobil Corporation has weight 0.0 %
Stock Kinder Morgan has weight 0.0 %
Stock ONEOK has weight 0.0 %
Stock Schlumberger has weight 0.0 %
Stock Williams Companies Inc. has weight 100.0 %
</code></pre></div></div> <h3 id="monte-carlo-weights-1">Monte Carlo weights</h3> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Stock Chevron Corporation has weight 8.4 %
Stock ConocoPhillips has weight 0.91 %
Stock EOG Resources, has weight 10.74 %
Stock Energy Transfer has weight 11.04 %
Stock Enterprise Products Partners has weight 0.2 %
Stock Exxon Mobil Corporation has weight 6.88 %
Stock Kinder Morgan has weight 0.12 %
Stock ONEOK has weight 3.85 %
Stock Schlumberger has weight 6.66 %
Stock Williams Companies Inc. has weight 51.2 %
</code></pre></div></div> <h3 id="comparison-and-metrics">Comparison and metrics</h3> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>For a given portfolio we have: (Using Markowitz - SciPy)
 

Return is : 0.24390270933462732

Volatility is : 0.35756417137002044

SharpeRatio is : 0.5589282239067767



For a given portfolio we have: (Using Monte Carlo)
 

Return is : 0.1876335670238803

Volatility is : 0.3455768547486279

SharpeRatio is : 0.41548952990569715
</code></pre></div></div> <h3 id="efficient-frontier-1">Efficient Frontier</h3> <p><img src="/assets/proj/Portfolio_Construction_files/es_2.png" alt="es2" style="max-width: 100%; height: auto;"></p> <h1 id="8-technology-sector-by-robert-roman">8. Technology Sector by <a href="https://www.linkedin.com/in/robert-roman-998b99213/?utm_source=share&amp;utm_campaign=share_via&amp;utm_content=profile&amp;utm_medium=ios_app" rel="external nofollow noopener" target="_blank"><strong>Robert Roman</strong></a> </h1> <blockquote> <p>NOTE:</p> <p>The approach is the same as the Financial Sector</p> </blockquote> <h2 id="data-processing-1">Data Processing</h2> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Tickers list
</span><span class="n">tickers_ts</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">NVDA</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">AAPL</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">MSFT</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">AMZN</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">GOOG</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">META</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">TSLA</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">CRM</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">AMD</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">BABA</span><span class="sh">"</span><span class="p">]</span>

<span class="c1"># Dictionary to store stocks' name
</span><span class="n">ticker_name_ts</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">"</span><span class="s">NVDA</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">NVIDIA</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">AAPL</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">APPLE</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">MSFT</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">MICROSOFT</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">AMZN</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">AMAZON</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">GOOG</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">GOOGLE</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">META</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">META</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">TSLA</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">TESLA</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">CRM</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">SALESFORCE</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">AMD</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">AMD</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">BABA</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">ALIBABA</span><span class="sh">"</span>
<span class="p">}</span>
</code></pre></div></div> <h3 id="optimal-weights-2">Optimal Weights</h3> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Stock NVIDIA has weight 86.26 %
Stock TESLA has weight 13.74 %
Stock APPLE has weight 0.0 %
Stock AMD has weight 0.0 %
Stock AMAZON has weight 0.0 %
Stock ALIBABA has weight 0.0 %
Stock SALESFORCE has weight 0.0 %
Stock GOOGLE has weight 0.0 %
Stock META has weight 0.0 %
Stock MICROSOFT has weight 0.0 %
</code></pre></div></div> <h3 id="monte-carlo-weights-2">Monte Carlo Weights</h3> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Stock NVIDIA has weight 51.2 %
Stock SALESFORCE has weight 11.04 %
Stock AMAZON has weight 10.74 %
Stock AMD has weight 8.4 %
Stock TESLA has weight 6.88 %
Stock MICROSOFT has weight 6.66 %
Stock META has weight 3.85 %
Stock APPLE has weight 0.91 %
Stock ALIBABA has weight 0.2 %
Stock GOOGLE has weight 0.12 %
</code></pre></div></div> <h3 id="comparison-and-metrics-1">Comparison and metrics</h3> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>For a given portfolio we have: (Using Markowitz - SciPy)
 

Return is : 0.620340335724262

Volatility is : 0.5153004255467142

SharpeRatio is : 1.1183579617943382



For a given portfolio we have: (Using Monte Carlo)
 

Return is : 0.4359913020704139

Volatility is : 0.41792222819928737

SharpeRatio is : 0.9378331027308557
</code></pre></div></div> <h3 id="efficient-frontier-2">Efficient Frontier</h3> <p><img src="/assets/proj/Portfolio_Construction_files/ts_2.png" alt="ts2" style="max-width: 100%; height: auto;"></p> <h1 id="9-health-sector-by-sahar-shirazi">9. Health Sector by <a href="https://www.linkedin.com/in/sahar-shirazi-906b3a167/" rel="external nofollow noopener" target="_blank"><strong>Sahar Shirazi</strong></a> </h1> <blockquote> <p>NOTE:</p> <p>The approach is the same as the Financial Sector</p> </blockquote> <h2 id="data-processing-2">Data Processing</h2> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># Tickers list
</span><span class="n">tickers_hs</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">JNJ</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">PFE</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">UNH</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">ABBV</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">MRK</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">TMO</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">LLY</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">MDT</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">AMGN</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">GILD</span><span class="sh">"</span><span class="p">]</span>
<span class="c1"># Dictionary to store stocks' name
</span>
<span class="n">ticker_name_hs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">"</span><span class="s">JNJ</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Johnson &amp; Johnson</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">PFE</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">BPfizer Inc. </span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">UNH</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">UnitedHealth Group Incorporated</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">ABBV</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">MAbbVie Inc.</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">MRK</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Merck &amp; Co., Inc.</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">TMO</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Thermo Fisher Scientific Inc.</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">LLY</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">REli Lilly and Company</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">MDT</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Medtronic plc</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">AMGN</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">GAmgen Inc.</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">GILD</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Gilead Sciences, Inc.</span><span class="sh">"</span>
<span class="p">}</span>
</code></pre></div></div> <h3 id="optimal-weights-3">Optimal Weights</h3> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Stock MAbbVie Inc. has weight 19.98 %
Stock GAmgen Inc. has weight 0.0 %
Stock Gilead Sciences, Inc. has weight 0.0 %
Stock Johnson &amp; Johnson has weight 0.0 %
Stock REli Lilly and Company has weight 80.02 %
Stock Medtronic plc has weight 0.0 %
Stock Merck &amp; Co., Inc. has weight 0.0 %
Stock BPfizer Inc.  has weight 0.0 %
Stock Thermo Fisher Scientific Inc. has weight 0.0 %
Stock UnitedHealth Group Incorporated has weight 0.0 %
</code></pre></div></div> <h3 id="monte-carlo-weights-3">Monte Carlo weights</h3> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Stock MAbbVie Inc. has weight 15.94 %
Stock GAmgen Inc. has weight 4.75 %
Stock Gilead Sciences, Inc. has weight 22.06 %
Stock Johnson &amp; Johnson has weight 1.09 %
Stock REli Lilly and Company has weight 30.06 %
Stock Medtronic plc has weight 1.31 %
Stock Merck &amp; Co., Inc. has weight 4.0 %
Stock BPfizer Inc.  has weight 2.17 %
Stock Thermo Fisher Scientific Inc. has weight 4.21 %
Stock UnitedHealth Group Incorporated has weight 14.42 %
</code></pre></div></div> <h3 id="comparison-and-metrics-2">Comparison and metrics</h3> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>For a given portfolio we have: (Using Markowitz - SciPy)
 

Return is : 0.3321472564404809

Volatility is : 0.28174588380820687

SharpeRatio is : 1.0225429044369432



For a given portfolio we have: (Using Monte Carlo)
 

Return is : 0.19652739686583295

Volatility is : 0.19970382890433205

SharpeRatio is : 0.7635176331085451
</code></pre></div></div> <h3 id="efficient-frontier-3">Efficient Frontier</h3> <p><img src="/assets/proj/Portfolio_Construction_files/hs_2.png" alt="hs2" style="max-width: 100%; height: auto;"></p> <h1 id="10-general-portfolio">10. General Portfolio</h1> <p>We ended up with the following stocks:</p> <ol> <li> <p>GOLDMAN SACHS GROUP</p> </li> <li> <p>COMMONWEALTH BANK OF AUS</p> </li> <li> <p>BERKSHIRE HATHAWAY B</p> </li> <li> <p>Williams Companies Inc.</p> </li> <li> <p>NVIDIA</p> </li> <li> <p>TESLA</p> </li> <li> <p>REli Lilly and Company</p> </li> <li> <p>AbbVie Inc.</p> </li> </ol> <h2 id="data-processing-3">Data Processing</h2> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">tickers_gp</span> <span class="o">=</span> <span class="p">[</span><span class="sh">"</span><span class="s">GS</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">CBA.AX</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">BRK-B</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">WMB</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">NVDA</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">TSLA</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">LLY</span><span class="sh">"</span><span class="p">,</span> <span class="sh">"</span><span class="s">ABBV</span><span class="sh">"</span><span class="p">]</span>
<span class="n">ticker_name_gp</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">"</span><span class="s">GS</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">GOLDMAN SACHS GROUP</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">CBA.AX</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">COMMONWEALTH BANK OF AUS</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">BRK-B</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">BERKSHIRE HATHAWAY B</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">WMB</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">Williams Companies Inc.</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">NVDA</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">NVIDIA</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">TSLA</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">TESLA</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">LLY</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">REli Lilly and Company</span><span class="sh">"</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">ABBV</span><span class="sh">"</span><span class="p">:</span> <span class="sh">"</span><span class="s">MAbbVie Inc.</span><span class="sh">"</span>
<span class="p">}</span>
</code></pre></div></div> <h3 id="optimal-weights-4">Optimal Weights</h3> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Stock REli Lilly and Company has weight 42.04 %
Stock NVIDIA has weight 25.42 %
Stock COMMONWEALTH BANK OF AUS has weight 21.3 %
Stock TESLA has weight 5.68 %
Stock Williams Companies Inc. has weight 4.72 %
Stock MAbbVie Inc. has weight 0.85 %
Stock BERKSHIRE HATHAWAY B has weight 0.0 %
Stock GOLDMAN SACHS GROUP has weight 0.0 %
</code></pre></div></div> <h3 id="monte-carlo-weights-4">Monte Carlo Weights</h3> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Stock REli Lilly and Company has weight 40.77 %
Stock NVIDIA has weight 23.62 %
Stock COMMONWEALTH BANK OF AUS has weight 20.53 %
Stock MAbbVie Inc. has weight 3.76 %
Stock GOLDMAN SACHS GROUP has weight 3.38 %
Stock TESLA has weight 3.12 %
Stock BERKSHIRE HATHAWAY B has weight 2.76 %
Stock Williams Companies Inc. has weight 2.06 %
</code></pre></div></div> <h3 id="comparison-and-metrics-3">Comparison and metrics</h3> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>For a given portfolio we have: (Using Markowitz - SciPy)
 

Return is : 0.40627639504115

Volatility is : 0.25896239653732983

SharpeRatio is : 1.3987605837237878



For a given portfolio we have: (Using Monte Carlo)
 

Return is : 0.38575239330114636

Volatility is : 0.247542089402651

SharpeRatio is : 1.3803809769386373
</code></pre></div></div> <h3 id="efficient-frontier-4">Efficient Frontier</h3> <p><img src="/assets/proj/Portfolio_Construction_files/gp_2.png" alt="gp" style="max-width: 100%; height: auto;"></p> <h3 id="piechart">Piechart</h3> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="c1"># Data for Optimization weights
</span><span class="n">optimization_weights</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">"</span><span class="s">REli Lilly and Company</span><span class="sh">"</span><span class="p">:</span> <span class="mf">42.04</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">NVIDIA</span><span class="sh">"</span><span class="p">:</span> <span class="mf">25.42</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">COMMONWEALTH BANK OF AUS</span><span class="sh">"</span><span class="p">:</span> <span class="mf">21.3</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">TESLA</span><span class="sh">"</span><span class="p">:</span> <span class="mf">5.68</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">Williams Companies Inc.</span><span class="sh">"</span><span class="p">:</span> <span class="mf">4.72</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">MAbbVie Inc.</span><span class="sh">"</span><span class="p">:</span> <span class="mf">0.85</span>
<span class="p">}</span>

<span class="c1"># Data for Monte Carlo weights
</span><span class="n">monte_carlo_weights</span> <span class="o">=</span> <span class="p">{</span>
    <span class="sh">"</span><span class="s">REli Lilly and Company</span><span class="sh">"</span><span class="p">:</span> <span class="mf">40.77</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">NVIDIA</span><span class="sh">"</span><span class="p">:</span> <span class="mf">23.62</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">COMMONWEALTH BANK OF AUS</span><span class="sh">"</span><span class="p">:</span> <span class="mf">20.53</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">MAbbVie Inc.</span><span class="sh">"</span><span class="p">:</span> <span class="mf">3.76</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">GOLDMAN SACHS GROUP</span><span class="sh">"</span><span class="p">:</span> <span class="mf">3.38</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">TESLA</span><span class="sh">"</span><span class="p">:</span> <span class="mf">3.12</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">BERKSHIRE HATHAWAY B</span><span class="sh">"</span><span class="p">:</span> <span class="mf">2.76</span><span class="p">,</span>
    <span class="sh">"</span><span class="s">Williams Companies Inc.</span><span class="sh">"</span><span class="p">:</span> <span class="mf">2.06</span>
<span class="p">}</span>

<span class="c1"># Extract labels and values for both strategies
</span><span class="n">labels_opt</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">optimization_weights</span><span class="p">.</span><span class="nf">keys</span><span class="p">())</span>
<span class="n">values_opt</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">optimization_weights</span><span class="p">.</span><span class="nf">values</span><span class="p">())</span>

<span class="n">labels_mc</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">monte_carlo_weights</span><span class="p">.</span><span class="nf">keys</span><span class="p">())</span>
<span class="n">values_mc</span> <span class="o">=</span> <span class="nf">list</span><span class="p">(</span><span class="n">monte_carlo_weights</span><span class="p">.</span><span class="nf">values</span><span class="p">())</span>

<span class="c1"># Create a figure with two subplots
</span><span class="n">fig</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">plt</span><span class="p">.</span><span class="nf">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">9</span><span class="p">))</span>

<span class="c1"># Plot Optimization weights pie chart
</span><span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">pie</span><span class="p">(</span>
    <span class="n">values_opt</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>  <span class="c1"># No labels directly on the chart
</span>    <span class="n">startangle</span><span class="o">=</span><span class="mi">90</span>
<span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">set_title</span><span class="p">(</span><span class="sh">'</span><span class="s">Markowitz Weights</span><span class="sh">'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="c1"># Add external legend for Optimization weights
</span><span class="n">opt_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="p">.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s">%</span><span class="sh">"</span> <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nf">zip</span><span class="p">(</span><span class="n">labels_opt</span><span class="p">,</span> <span class="n">values_opt</span><span class="p">)]</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nf">legend</span><span class="p">(</span><span class="n">opt_labels</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="sh">"</span><span class="s">center left</span><span class="sh">"</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>

<span class="c1"># Plot Monte Carlo weights pie chart
</span><span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nf">pie</span><span class="p">(</span>
    <span class="n">values_mc</span><span class="p">,</span>
    <span class="n">labels</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span>  <span class="c1"># No labels directly on the chart
</span>    <span class="n">startangle</span><span class="o">=</span><span class="mi">90</span>
<span class="p">)</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nf">set_title</span><span class="p">(</span><span class="sh">'</span><span class="s">Monte Carlo Weights</span><span class="sh">'</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="c1"># Add external legend for Monte Carlo weights
</span><span class="n">mc_labels</span> <span class="o">=</span> <span class="p">[</span><span class="sa">f</span><span class="sh">"</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s">: </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="p">.</span><span class="mi">2</span><span class="n">f</span><span class="si">}</span><span class="s">%</span><span class="sh">"</span> <span class="k">for</span> <span class="n">label</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nf">zip</span><span class="p">(</span><span class="n">labels_mc</span><span class="p">,</span> <span class="n">values_mc</span><span class="p">)]</span>
<span class="n">axes</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nf">legend</span><span class="p">(</span><span class="n">mc_labels</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="sh">"</span><span class="s">center left</span><span class="sh">"</span><span class="p">,</span> <span class="n">bbox_to_anchor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>

<span class="c1"># Adjust layout for better display
</span><span class="n">plt</span><span class="p">.</span><span class="nf">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="p">.</span><span class="nf">show</span><span class="p">()</span>

</code></pre></div></div> <p><img src="/assets/proj/Portfolio_Construction_files/weights.png" alt="weights" style="max-width: 100%; height: auto;"></p> <h1 id="references">References</h1> <ul> <li> <p><a href="https://www.jstor.org/stable/2975974" rel="external nofollow noopener" target="_blank">Markowitz, H. (1952). Portfolio Selection. The Journal of Finance, 7(1), 77-91. Wiley for the American Finance Association</a></p> </li> <li> <p><a href="https://www.kaggle.com/code/bhavinmoriya/markowitz-portfolio-optimization" rel="external nofollow noopener" target="_blank">https://www.kaggle.com/code/bhavinmoriya/markowitz-portfolio-optimization</a></p> </li> </ul> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Tommaso de Martino. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> </body> </html>